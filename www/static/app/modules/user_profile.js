/*! xshowroom - v1.0.0 - 2016-01-15 */angular.module("xShowroom.user.profile",["ngCookies","xShowroom.i18n","xShowroom.directives"]).controller("UserProfileCtrl",["$scope","$window","$filter","$modal","Country","User",function(a,b,c,d,e,f){a.isEditing=!1,a.countries=e.getAll(),a.checkInfo={validation:{user:{firstName:!1,lastName:!1,displayName:!1,tel:!1},brand:{designerName:!1,categoryType:!1,imagePath:!1},company:{companyAddr:!1,companyCountry:!1,companyZip:!1,companyTel:!1,companyWebsite:!1}},reg:{user:{firstName:/^\S{1,50}$/,lastName:/^\S{1,50}$/,tel:/^\S{6,20}$/},brand:{},company:{companyWebsite:/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-@?^=%&amp;/~\+#])?/}}},a.edit=function(){a.isEditing=!a.isEditing},a.reload=function(){b.location.reload()},a.check=function(b,c){for(var d in c)if("mobile"!=d&&"description"!=d&&"brandUrl"!=d){var e=c[d];e&&""!=e?!a.checkInfo.reg[b][d]||a.checkInfo.reg[b][d].test(e)?a.checkInfo.validation[b][d]=!1:(a.errorMsgs.push([d,"PATTERN_ERROR"]),a.checkInfo.validation[b][d]=!0):(a.errorMsgs.push([d,"EMPTY_ERROR"]),a.checkInfo.validation[b][d]=!0)}},a.setCollection=function(b){var c=a.brand.categoryType?a.brand.categoryType.split(","):[],d=c.indexOf(b);d>=0?c.splice(d,1):c.push(b),a.brand.categoryType=c.join(",")},a.initCategory=function(){for(var b=a.brand.categoryType.split(","),c=0,d=b.length;d>c;c++)a[b[c]]=!0},a.getCategory=function(){for(var b=[],d=a.brand.categoryType.split(","),e=0,f=d.length;f>e;e++)d[e]&&b.push(c("translate")(d[e]));return b.join(",")||"(N/A)"},a.save=function(){a.errorMsgs=[];var e={};a.user&&(a.check("user",a.user),e=angular.extend(e,a.user)),a.company&&(a.check("company",a.company),e=angular.extend(e,a.company)),a.brand&&(a.check("brand",a.brand),e=angular.extend(e,a.brand)),a.errorMsgs.length||f.updateProfile(e).success(function(a){"object"!=typeof a||a.status?d({title:c("translate")("modal__title__ERROR"),content:a.msg,show:!0}):b.location.reload()})}}]);