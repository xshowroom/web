/*! xshowroom - v1.0.0 - 2016-01-15 */angular.module("xShowroom.login",["ngCookies","xShowroom.i18n","xShowroom.directives","xShowroom.services"]).controller("LoginCtrl",["$scope","$cookies","User","$filter",function($scope,$cookies,User,$filter){$scope.rememberMe=eval($cookies.get("rememberMe")),$scope.user={email:$scope.rememberMe?$cookies.get("email"):""},$scope.refreshValidCode=function(){$scope.validCodeUrl="/api/image?rnd="+(new Date).getTime()},$scope.refreshValidCode(),$scope.loginError={hasError:!1,errorMsg:""},$scope.login=function(){var a=User.login($scope.user),b=/^([a-zA-Z0-9])+([a-zA-Z0-9_-])*@([a-zA-Z0-9_-])+\.([a-zA-Z0-9_-])+/;return b.test($scope.user.email)?void a.success(function(a){return"object"!=typeof a||a.status?($scope.refreshValidCode(),void($scope.loginError={hasError:!0,errorMsg:a.msg})):($cookies.put("rememberMe",$scope.rememberMe),$scope.rememberMe&&$cookies.put("email",$scope.user.email),void window.open("/user/login","_self"))}):void($scope.loginError={hasError:!0,errorMsg:$filter("translate")("login__EMAIL_PATTERN_ERROR")})}}]);